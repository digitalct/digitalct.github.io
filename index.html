<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Personal Dashboard — Raj</title>
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    :root{--bg:#0f1724;--card:#0b1220;--muted:#9aa7bf;--accent:#06b6d4;--glass: rgba(255,255,255,0.03)}
    *{box-sizing:border-box;font-family:Inter,system-ui,Segoe UI,Roboto,'Helvetica Neue',Arial}
    body{margin:0;background:linear-gradient(180deg,#071427 0%, #071b2a 100%);color:#e6eef8;min-height:100vh}
    .wrap{max-width:1200px;margin:28px auto;padding:20px}
    header{display:flex;gap:20px;align-items:center}
    h1{margin:0;font-size:20px}
    .grid{display:grid;grid-template-columns:320px 1fr;gap:20px;margin-top:18px}
    .panel{background:var(--card);padding:14px;border-radius:10px;box-shadow:0 6px 18px rgba(2,6,23,0.6)}
    nav button{display:block;width:100%;text-align:left;padding:10px;border-radius:8px;border:none;background:transparent;color:var(--muted);margin-bottom:6px}
    nav button.active{background:var(--glass);color:#fff}
    .content{padding:6px}
    label{display:block;font-size:13px;color:var(--muted);margin-top:10px}
    input,select,textarea{width:100%;padding:8px;margin-top:6px;border-radius:6px;border:1px solid rgba(255,255,255,0.06);background:transparent;color:inherit}
    table{width:100%;border-collapse:collapse;margin-top:10px}
    th,td{padding:8px;border-bottom:1px dashed rgba(255,255,255,0.03);font-size:13px}
    .row{display:flex;gap:12px}
    .row>div{flex:1}
    .btn{padding:8px 12px;border-radius:8px;border:none;background:var(--accent);color:#042033;cursor:pointer;margin-top:10px}
    .small{font-size:12px;color:var(--muted)}
    .topcards{display:flex;gap:12px;margin-bottom:12px}
    .card{flex:1;padding:12px;border-radius:10px;background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01))}
    .chart-wrap{background:var(--glass);padding:10px;border-radius:8px}
    .actions{display:flex;gap:8px;flex-wrap:wrap}
    footer{margin-top:18px;color:var(--muted);font-size:12px}
    .muted{color:var(--muted)}
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <h1>Personal Dashboard — Raj (INR ₹)</h1>
      <div style="margin-left:auto" class="small muted">Autosaves locally in your browser (LocalStorage)</div>
    </header>

    <div class="grid">
      <aside class="panel">
        <nav id="nav">
          <button data-view="dashboard" class="active">Dashboard</button>
          <button data-view="family">Family Info</button>
          <button data-view="assets">Assets</button>
          <button data-view="liabilities">Liabilities</button>
          <button data-view="accomplishments">Accomplishments</button>
          <button data-view="goals">Goals</button>
          <hr style="opacity:0.06;margin:12px 0">
          <div class="actions">
            <button id="exportBtn" class="btn">Export JSON</button>
            <button id="importBtn" class="btn" style="background:#fff;color:#042033">Import JSON</button>
            <input type="file" id="fileInput" style="display:none" accept="application/json">
          </div>
        </nav>
      </aside>

      <main>
        <!-- DASHBOARD -->
        <section id="view-dashboard" class="panel view">
          <div class="topcards">
            <div class="card">
              <div class="small">Total Assets</div>
              <div id="totalAssets" style="font-size:20px;font-weight:700">₹ 0</div>
            </div>
            <div class="card">
              <div class="small">Total Liabilities</div>
              <div id="totalLiabilities" style="font-size:20px;font-weight:700">₹ 0</div>
            </div>
            <div class="card">
              <div class="small">Net Worth</div>
              <div id="netWorth" style="font-size:20px;font-weight:700">₹ 0</div>
            </div>
          </div>

          <div style="display:flex;gap:12px;align-items:flex-start">
            <div style="flex:1" class="chart-wrap">
              <canvas id="assetChart" height="220"></canvas>
            </div>
            <div style="width:360px">
              <div class="panel" style="padding:10px;margin-bottom:12px">
                <div class="small">Upcoming Goals</div>
                <ul id="upcomingGoals" class="small muted"></ul>
              </div>

              <div class="panel" style="padding:10px">
                <div class="small">Family Ages</div>
                <canvas id="ageChart" height="180"></canvas>
              </div>
            </div>
          </div>

          <div style="margin-top:12px" class="panel">
            <div class="small">Top 5 Accomplishments</div>
            <ol id="topAccomplishments" class="small muted"></ol>
          </div>
        </section>

        <!-- FAMILY -->
        <section id="view-family" style="display:none" class="panel view">
          <div class="row">
            <div>
              <label>Name</label>
              <input id="fName" placeholder="Name">
            </div>
            <div>
              <label>Relation</label>
              <input id="fRel" placeholder="Relation">
            </div>
          </div>
          <div class="row">
            <div>
              <label>DOB</label>
              <input id="fDob" type="date">
            </div>
            <div>
              <label>Occupation</label>
              <input id="fOcc">
            </div>
          </div>
          <label>Notes</label>
          <textarea id="fNotes" rows="2"></textarea>
          <button id="addFamily" class="btn">Add / Update</button>

          <table id="familyTable"><thead><tr><th>Name</th><th>Relation</th><th>DOB</th><th>Age</th><th>Occupation</th><th></th></tr></thead><tbody></tbody></table>
        </section>

        <!-- ASSETS -->
        <section id="view-assets" style="display:none" class="panel view">
          <div class="row">
            <div>
              <label>Asset Type</label>
              <input id="aType" placeholder="e.g. Real Estate">
            </div>
            <div>
              <label>Description</label>
              <input id="aDesc" placeholder="e.g. Flat in Pune">
            </div>
          </div>
          <div class="row">
            <div>
              <label>Value (₹)</label>
              <input id="aValue" type="number" placeholder="0">
            </div>
            <div>
              <label>Owner</label>
              <input id="aOwner" placeholder="Self / Joint / Spouse">
            </div>
          </div>
          <button id="addAsset" class="btn">Add / Update Asset</button>

          <table id="assetsTable"><thead><tr><th>Type</th><th>Description</th><th>Value (₹)</th><th>Owner</th><th></th></tr></thead><tbody></tbody></table>
        </section>

        <!-- LIABILITIES -->
        <section id="view-liabilities" style="display:none" class="panel view">
          <div class="row">
            <div>
              <label>Loan Type</label>
              <input id="lType">
            </div>
            <div>
              <label>Lender</label>
              <input id="lLender">
            </div>
          </div>
          <div class="row">
            <div>
              <label>Amount (₹)</label>
              <input id="lAmount" type="number">
            </div>
            <div>
              <label>EMI (₹)</label>
              <input id="lEmi" type="number">
            </div>
          </div>
          <div class="row">
            <div>
              <label>End Date</label>
              <input id="lEnd" type="date">
            </div>
            <div>
              <label>Remarks</label>
              <input id="lRemarks">
            </div>
          </div>
          <button id="addLiability" class="btn">Add / Update Liability</button>

          <table id="liabilitiesTable"><thead><tr><th>Loan</th><th>Lender</th><th>Amount (₹)</th><th>EMI</th><th>End Date</th><th></th></tr></thead><tbody></tbody></table>
        </section>

        <!-- ACCOMPLISHMENTS -->
        <section id="view-accomplishments" style="display:none" class="panel view">
          <div class="row">
            <div>
              <label>Year</label>
              <input id="acYear" type="number" placeholder="2025">
            </div>
            <div>
              <label>Type</label>
              <input id="acType" placeholder="Career / Personal / Financial">
            </div>
          </div>
          <label>Description</label>
          <textarea id="acDesc" rows="2"></textarea>
          <label>Value (₹) — optional</label>
          <input id="acValue" type="number">
          <button id="addAccomplishment" class="btn">Add</button>

          <table id="accomplishmentsTable"><thead><tr><th>Year</th><th>Type</th><th>Description</th><th>Value</th><th></th></tr></thead><tbody></tbody></table>
        </section>

        <!-- GOALS -->
        <section id="view-goals" style="display:none" class="panel view">
          <label>Target</label>
          <input id="gTarget">
          <div class="row">
            <div>
              <label>Category</label>
              <input id="gCategory">
            </div>
            <div>
              <label>Deadline</label>
              <input id="gDeadline" type="date">
            </div>
          </div>
          <label>Status</label>
          <input id="gStatus" placeholder="Planned / Ongoing / Done">
          <button id="addGoal" class="btn">Add Goal</button>

          <table id="goalsTable"><thead><tr><th>Target</th><th>Category</th><th>Deadline</th><th>Status</th><th></th></tr></thead><tbody></tbody></table>
        </section>

      </main>
    </div>

    <footer>Tip: Use <strong>Export JSON</strong> to backup. Open this file in your browser anytime to continue editing. Want a multi-user version? Ask for a server+database build.</footer>
  </div>

<script>
// Simple SPA navigation
const nav = document.getElementById('nav');
nav.addEventListener('click', e => {
  if(e.target.matches('button')){
    [...nav.querySelectorAll('button')].forEach(b=>b.classList.remove('active'));
    e.target.classList.add('active');
    showView(e.target.dataset.view);
  }
});
function showView(name){
  document.querySelectorAll('.view').forEach(s=>s.style.display='none');
  const el = document.getElementById('view-'+name);
  if(el) el.style.display='block';
  refreshUI();
}

// Data model stored in localStorage
const STORAGE_KEY = 'personal_dashboard_v1';
let model = { family: [], assets: [], liabilities: [], accomplishments: [], goals: [] };

function load(){
  try{ const raw = localStorage.getItem(STORAGE_KEY); if(raw) model = JSON.parse(raw); }
  catch(e){ console.error('load err',e); }
}
function save(){ localStorage.setItem(STORAGE_KEY, JSON.stringify(model)); renderDashboard(); }

// Utility
function fmt(n){ if(!n && n !== 0) return '₹ 0'; return '₹ ' + Number(n).toLocaleString('en-IN'); }
function calcAge(dob){ if(!dob) return ''; const b=new Date(dob); const t=new Date(); let y=t.getFullYear()-b.getFullYear(); const m=t.getMonth()-b.getMonth(); if(m<0 || (m===0 && t.getDate()<b.getDate())) y--; return y; }

// --- Family CRUD ---
document.getElementById('addFamily').addEventListener('click', ()=>{
  const name=document.getElementById('fName').value.trim(); if(!name) return alert('Name required');
  const rec = { name, relation: document.getElementById('fRel').value.trim(), dob: document.getElementById('fDob').value, occupation: document.getElementById('fOcc').value.trim(), notes: document.getElementById('fNotes').value.trim() };
  // if exists update
  const idx = model.family.findIndex(x=>x.name.toLowerCase()===name.toLowerCase());
  if(idx>=0) model.family[idx]=rec; else model.family.push(rec);
  save(); clearFamilyForm(); refreshUI();
});
function clearFamilyForm(){ ['fName','fRel','fDob','fOcc','fNotes'].forEach(id=>document.getElementById(id).value=''); }

// Assets CRUD
document.getElementById('addAsset').addEventListener('click', ()=>{
  const t=document.getElementById('aType').value.trim(); if(!t) return alert('Asset type required');
  const rec={ type:t, description:document.getElementById('aDesc').value.trim(), value:Number(document.getElementById('aValue').value||0), owner:document.getElementById('aOwner').value.trim() };
  model.assets.push(rec); save(); clearAssetForm(); refreshUI();
});
function clearAssetForm(){ ['aType','aDesc','aValue','aOwner'].forEach(id=>document.getElementById(id).value=''); }

// Liabilities
document.getElementById('addLiability').addEventListener('click', ()=>{
  const t=document.getElementById('lType').value.trim(); if(!t) return alert('Loan type required');
  const rec={ loan:t, lender:document.getElementById('lLender').value.trim(), amount:Number(document.getElementById('lAmount').value||0), emi:Number(document.getElementById('lEmi').value||0), endDate:document.getElementById('lEnd').value, remarks:document.getElementById('lRemarks').value }
  model.liabilities.push(rec); save(); clearLiabForm(); refreshUI();
});
function clearLiabForm(){ ['lType','lLender','lAmount','lEmi','lEnd','lRemarks'].forEach(id=>document.getElementById(id).value=''); }

// Accomplishments
document.getElementById('addAccomplishment').addEventListener('click', ()=>{
  const yr=document.getElementById('acYear').value; const type=document.getElementById('acType').value.trim(); const desc=document.getElementById('acDesc').value.trim(); if(!desc) return alert('Description required');
  const rec={ year:yr||'', type:type||'', description:desc, value: Number(document.getElementById('acValue').value||0) };
  model.accomplishments.push(rec); save(); ['acYear','acType','acDesc','acValue'].forEach(id=>document.getElementById(id).value=''); refreshUI();
});

// Goals
document.getElementById('addGoal').addEventListener('click', ()=>{
  const t=document.getElementById('gTarget').value.trim(); if(!t) return alert('Target required');
  const rec={ target:t, category:document.getElementById('gCategory').value.trim(), deadline:document.getElementById('gDeadline').value, status:document.getElementById('gStatus').value.trim() };
  model.goals.push(rec); save(); ['gTarget','gCategory','gDeadline','gStatus'].forEach(id=>document.getElementById(id).value=''); refreshUI();
});

// Table render helpers
function renderFamily(){ const tbody=document.querySelector('#familyTable tbody'); tbody.innerHTML=''; model.family.forEach((f,i)=>{
  const tr=document.createElement('tr'); tr.innerHTML=`<td>${f.name}</td><td>${f.relation}</td><td>${f.dob||''}</td><td>${f.dob?calcAge(f.dob):''}</td><td>${f.occupation||''}</td><td><button data-i='${i}' class='delFam'>Delete</button></td>`; tbody.appendChild(tr);
});}

function renderAssets(){ const tbody=document.querySelector('#assetsTable tbody'); tbody.innerHTML=''; model.assets.forEach((a,i)=>{
  const tr=document.createElement('tr'); tr.innerHTML=`<td>${a.type}</td><td>${a.description||''}</td><td>${a.value?Number(a.value).toLocaleString('en-IN'):''}</td><td>${a.owner||''}</td><td><button data-i='${i}' class='delAsset'>Delete</button></td>`; tbody.appendChild(tr);
});}

function renderLiabilities(){ const tbody=document.querySelector('#liabilitiesTable tbody'); tbody.innerHTML=''; model.liabilities.forEach((l,i)=>{
  const tr=document.createElement('tr'); tr.innerHTML=`<td>${l.loan}</td><td>${l.lender||''}</td><td>${l.amount?Number(l.amount).toLocaleString('en-IN'):''}</td><td>${l.emi?Number(l.emi).toLocaleString('en-IN'):''}</td><td>${l.endDate||''}</td><td><button data-i='${i}' class='delLiab'>Delete</button></td>`; tbody.appendChild(tr);
});}

function renderAccomplishments(){ const tbody=document.querySelector('#accomplishmentsTable tbody'); tbody.innerHTML=''; model.accomplishments.forEach((a,i)=>{
  const tr=document.createElement('tr'); tr.innerHTML=`<td>${a.year||''}</td><td>${a.type||''}</td><td>${a.description}</td><td>${a.value?Number(a.value).toLocaleString('en-IN'):''}</td><td><button data-i='${i}' class='delAc'>Delete</button></td>`; tbody.appendChild(tr);
});}

function renderGoals(){ const tbody=document.querySelector('#goalsTable tbody'); tbody.innerHTML=''; model.goals.forEach((g,i)=>{
  const tr=document.createElement('tr'); tr.innerHTML=`<td>${g.target}</td><td>${g.category||''}</td><td>${g.deadline||''}</td><td>${g.status||''}</td><td><button data-i='${i}' class='delGoal'>Delete</button></td>`; tbody.appendChild(tr);
});}

// Delegated delete handlers
document.addEventListener('click', e=>{
  if(e.target.classList.contains('delFam')){ model.family.splice(+e.target.dataset.i,1); save(); refreshUI(); }
  if(e.target.classList.contains('delAsset')){ model.assets.splice(+e.target.dataset.i,1); save(); refreshUI(); }
  if(e.target.classList.contains('delLiab')){ model.liabilities.splice(+e.target.dataset.i,1); save(); refreshUI(); }
  if(e.target.classList.contains('delAc')){ model.accomplishments.splice(+e.target.dataset.i,1); save(); refreshUI(); }
  if(e.target.classList.contains('delGoal')){ model.goals.splice(+e.target.dataset.i,1); save(); refreshUI(); }
});

// Dashboard render
let assetChart, ageChart;
function renderDashboard(){
  const totalAssets = model.assets.reduce((s,a)=>s + (Number(a.value)||0),0);
  const totalLiabilities = model.liabilities.reduce((s,l)=>s + (Number(l.amount)||0),0);
  document.getElementById('totalAssets').textContent = fmt(totalAssets);
  document.getElementById('totalLiabilities').textContent = fmt(totalLiabilities);
  document.getElementById('netWorth').textContent = fmt(totalAssets - totalLiabilities);

  // Asset chart
  const labels = model.assets.map(a=>a.type + (a.description?(' — '+a.description):''));
  const values = model.assets.map(a=>Number(a.value)||0);
  if(assetChart) assetChart.destroy();
  const ctx = document.getElementById('assetChart').getContext('2d');
  assetChart = new Chart(ctx, { type:'pie', data:{ labels, datasets:[{ data: values }] }, options:{ plugins:{ legend:{display:true}}}});

  // Age chart
  const famNames = model.family.map(f=>f.name);
  const famAges = model.family.map(f=>f.dob?calcAge(f.dob):0);
  if(ageChart) ageChart.destroy();
  const ctx2 = document.getElementById('ageChart').getContext('2d');
  ageChart = new Chart(ctx2, { type:'bar', data:{ labels:famNames, datasets:[{ label:'Age', data:famAges }] }, options:{ scales:{ y:{ beginAtZero:true } }}});

  // Upcoming goals
  const up = model.goals.filter(g=>g.deadline).slice(0,5);
  const ug = document.getElementById('upcomingGoals'); ug.innerHTML=''; up.forEach(g=>{ const li=document.createElement('li'); li.textContent = `${g.target} — ${g.deadline} [${g.status||'—'}]`; ug.appendChild(li); });

  // Top accomplishments
  const ac = model.accomplishments.slice(-5).reverse(); const acEl=document.getElementById('topAccomplishments'); acEl.innerHTML=''; ac.forEach(x=>{ const li=document.createElement('li'); li.textContent = `${x.year?x.year+' — ':''}${x.type?x.type+': ':''}${x.description}`; acEl.appendChild(li); });
}

function refreshUI(){ renderFamily(); renderAssets(); renderLiabilities(); renderAccomplishments(); renderGoals(); renderDashboard(); }

// Export / Import
document.getElementById('exportBtn').addEventListener('click', ()=>{
  const blob = new Blob([JSON.stringify(model, null, 2)], {type:'application/json'});
  const url = URL.createObjectURL(blob); const a = document.createElement('a'); a.href=url; a.download='personal_dashboard_backup.json'; a.click(); URL.revokeObjectURL(url);
});
document.getElementById('importBtn').addEventListener('click', ()=>document.getElementById('fileInput').click());
document.getElementById('fileInput').addEventListener('change', e=>{
  const f = e.target.files[0]; if(!f) return; const r = new FileReader(); r.onload = ev=>{ try{ const data = JSON.parse(ev.target.result); model = data; save(); refreshUI(); alert('Imported successfully'); } catch(err){ alert('Invalid file'); }}; r.readAsText(f);
});

// init
load(); // seed with basic family members if empty
if(!model.family.length){ model.family = [ {name:'Mother', relation:'Mother', dob:'', occupation:'', notes:''}, {name:'Raj (You)', relation:'Self', dob:'1988-08-20', occupation:'Scientist', notes:''}, {name:'Spouse', relation:'Spouse', dob:'', occupation:'', notes:''}, {name:'Kid 1', relation:'Child', dob:'', occupation:'', notes:''}, {name:'Kid 2', relation:'Child', dob:'', occupation:'', notes:''}, {name:'Kid 3', relation:'Child', dob:'', occupation:'', notes:''} ]; save(); }
refreshUI();

// show dashboard by default
showView('dashboard');
</script>
</body>
</html>
